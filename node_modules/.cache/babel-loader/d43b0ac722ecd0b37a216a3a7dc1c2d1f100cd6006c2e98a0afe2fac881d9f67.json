{"ast":null,"code":"import axios from 'axios';\n\n/**\r\n * Shërbimi për menaxhimin e IPTV listave\r\n */\nexport const fetchChannelsFromM3U = async m3uUrl => {\n  try {\n    const response = await axios.get(m3uUrl, {\n      timeout: 15000,\n      headers: {\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'\n      }\n    });\n    const m3uContent = response.data;\n    return parseM3U(m3uContent);\n  } catch (error) {\n    console.error('Gabim gjatë ngarkimit të listës:', error);\n    throw new Error('Nuk mund të ngarkohet lista. Kontrollo URL-në dhe internetin.');\n  }\n};\n\n/**\r\n * Parse M3U content\r\n */\nconst parseM3U = content => {\n  const lines = content.split('\\n');\n  const channels = [];\n  let currentChannel = {};\n  for (let i = 0; i < lines.length; i++) {\n    const line = lines[i].trim();\n    if (line.startsWith('#EXTINF:')) {\n      currentChannel = parseExtInf(line);\n    } else if (line && !line.startsWith('#') && line.includes('://')) {\n      currentChannel.streamUrl = line;\n      if (currentChannel.name && currentChannel.streamUrl) {\n        channels.push({\n          ...currentChannel\n        });\n      }\n      currentChannel = {};\n    } else if (line.startsWith('#EXTGRP:')) {\n      const group = line.replace('#EXTGRP:', '').trim();\n      currentChannel.group = group;\n    } else if (line.startsWith('#EXTIMG:')) {\n      const logo = line.replace('#EXTIMG:', '').trim();\n      currentChannel.logo = logo;\n    }\n  }\n  return channels;\n};\n\n/**\r\n * Parse EXTINF line\r\n */\nconst parseExtInf = line => {\n  const channel = {};\n\n  // Extract attributes\n  const attributesMatch = line.match(/:(.*?),(.*)/);\n  if (!attributesMatch) return channel;\n  const [, attributes, name] = attributesMatch;\n  channel.name = name.trim();\n\n  // Parse attributes like tvg-id, tvg-logo, etc.\n  const attrRegex = /(\\S+?)=\"([^\"]*)\"/g;\n  let match;\n  while ((match = attrRegex.exec(attributes)) !== null) {\n    const [, key, value] = match;\n    switch (key) {\n      case 'tvg-id':\n        channel.tvgId = value;\n        break;\n      case 'tvg-name':\n        channel.tvgName = value;\n        break;\n      case 'tvg-logo':\n        channel.logo = value;\n        break;\n      case 'group-title':\n        channel.group = value;\n        break;\n      case 'tvg-language':\n        channel.language = value;\n        break;\n      case 'tvg-country':\n        channel.country = value;\n        break;\n    }\n  }\n  return channel;\n};\n\n/**\r\n * Test playlist connection\r\n */\nexport const testPlaylistConnection = async playlistUrl => {\n  try {\n    const response = await axios.head(playlistUrl, {\n      timeout: 10000\n    });\n    return response.status === 200;\n  } catch (error) {\n    console.warn('Testi i lidhjes dështoi, por mund të provojmë me GET:', error);\n    try {\n      const response = await axios.get(playlistUrl, {\n        timeout: 10000\n      });\n      return response.status === 200;\n    } catch (e) {\n      return false;\n    }\n  }\n};\n\n/**\r\n * Test Xtream Codes connection\r\n */\nexport const testXtreamConnection = async (serverUrl, username, password) => {\n  try {\n    const cleanUrl = serverUrl.replace(/\\/$/, '');\n    const testUrl = `${cleanUrl}/player_api.php?username=${username}&password=${password}`;\n    const response = await axios.get(testUrl, {\n      timeout: 10000\n    });\n    return response.data && response.data.user_info;\n  } catch (error) {\n    console.error('Gabim testimi Xtream:', error);\n    return false;\n  }\n};","map":{"version":3,"names":["axios","fetchChannelsFromM3U","m3uUrl","response","get","timeout","headers","m3uContent","data","parseM3U","error","console","Error","content","lines","split","channels","currentChannel","i","length","line","trim","startsWith","parseExtInf","includes","streamUrl","name","push","group","replace","logo","channel","attributesMatch","match","attributes","attrRegex","exec","key","value","tvgId","tvgName","language","country","testPlaylistConnection","playlistUrl","head","status","warn","e","testXtreamConnection","serverUrl","username","password","cleanUrl","testUrl","user_info"],"sources":["C:/Users/rayuv/OneDrive/Documents/GitHub/Reacttv/src/services/iptvService.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n/**\r\n * Shërbimi për menaxhimin e IPTV listave\r\n */\r\nexport const fetchChannelsFromM3U = async (m3uUrl) => {\r\n  try {\r\n    const response = await axios.get(m3uUrl, {\r\n      timeout: 15000,\r\n      headers: {\r\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'\r\n      }\r\n    });\r\n\r\n    const m3uContent = response.data;\r\n    return parseM3U(m3uContent);\r\n  } catch (error) {\r\n    console.error('Gabim gjatë ngarkimit të listës:', error);\r\n    throw new Error('Nuk mund të ngarkohet lista. Kontrollo URL-në dhe internetin.');\r\n  }\r\n};\r\n\r\n/**\r\n * Parse M3U content\r\n */\r\nconst parseM3U = (content) => {\r\n  const lines = content.split('\\n');\r\n  const channels = [];\r\n  let currentChannel = {};\r\n\r\n  for (let i = 0; i < lines.length; i++) {\r\n    const line = lines[i].trim();\r\n\r\n    if (line.startsWith('#EXTINF:')) {\r\n      currentChannel = parseExtInf(line);\r\n    } else if (line && !line.startsWith('#') && line.includes('://')) {\r\n      currentChannel.streamUrl = line;\r\n      if (currentChannel.name && currentChannel.streamUrl) {\r\n        channels.push({ ...currentChannel });\r\n      }\r\n      currentChannel = {};\r\n    } else if (line.startsWith('#EXTGRP:')) {\r\n      const group = line.replace('#EXTGRP:', '').trim();\r\n      currentChannel.group = group;\r\n    } else if (line.startsWith('#EXTIMG:')) {\r\n      const logo = line.replace('#EXTIMG:', '').trim();\r\n      currentChannel.logo = logo;\r\n    }\r\n  }\r\n\r\n  return channels;\r\n};\r\n\r\n/**\r\n * Parse EXTINF line\r\n */\r\nconst parseExtInf = (line) => {\r\n  const channel = {};\r\n  \r\n  // Extract attributes\r\n  const attributesMatch = line.match(/:(.*?),(.*)/);\r\n  if (!attributesMatch) return channel;\r\n  \r\n  const [, attributes, name] = attributesMatch;\r\n  channel.name = name.trim();\r\n  \r\n  // Parse attributes like tvg-id, tvg-logo, etc.\r\n  const attrRegex = /(\\S+?)=\"([^\"]*)\"/g;\r\n  let match;\r\n  while ((match = attrRegex.exec(attributes)) !== null) {\r\n    const [, key, value] = match;\r\n    switch (key) {\r\n      case 'tvg-id':\r\n        channel.tvgId = value;\r\n        break;\r\n      case 'tvg-name':\r\n        channel.tvgName = value;\r\n        break;\r\n      case 'tvg-logo':\r\n        channel.logo = value;\r\n        break;\r\n      case 'group-title':\r\n        channel.group = value;\r\n        break;\r\n      case 'tvg-language':\r\n        channel.language = value;\r\n        break;\r\n      case 'tvg-country':\r\n        channel.country = value;\r\n        break;\r\n    }\r\n  }\r\n  \r\n  return channel;\r\n};\r\n\r\n/**\r\n * Test playlist connection\r\n */\r\nexport const testPlaylistConnection = async (playlistUrl) => {\r\n  try {\r\n    const response = await axios.head(playlistUrl, { timeout: 10000 });\r\n    return response.status === 200;\r\n  } catch (error) {\r\n    console.warn('Testi i lidhjes dështoi, por mund të provojmë me GET:', error);\r\n    try {\r\n      const response = await axios.get(playlistUrl, { timeout: 10000 });\r\n      return response.status === 200;\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Test Xtream Codes connection\r\n */\r\nexport const testXtreamConnection = async (serverUrl, username, password) => {\r\n  try {\r\n    const cleanUrl = serverUrl.replace(/\\/$/, '');\r\n    const testUrl = `${cleanUrl}/player_api.php?username=${username}&password=${password}`;\r\n    \r\n    const response = await axios.get(testUrl, { timeout: 10000 });\r\n    return response.data && response.data.user_info;\r\n  } catch (error) {\r\n    console.error('Gabim testimi Xtream:', error);\r\n    return false;\r\n  }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}