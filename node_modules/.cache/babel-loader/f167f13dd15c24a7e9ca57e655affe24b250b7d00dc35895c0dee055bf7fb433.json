{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\rayuv\\\\OneDrive\\\\Documents\\\\GitHub\\\\Reacttv\\\\src\\\\components\\\\HlsPlayer.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from 'react';\nimport Hls from 'hls.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction HlsPlayer({\n  src,\n  isPlaying,\n  volume,\n  quality,\n  className\n}) {\n  _s();\n  const videoRef = useRef(null);\n  const hlsRef = useRef(null);\n  useEffect(() => {\n    if (!src || !videoRef.current) return;\n    const video = videoRef.current;\n\n    // Cleanup previous HLS instance\n    if (hlsRef.current) {\n      hlsRef.current.destroy();\n      hlsRef.current = null;\n    }\n\n    // Check if HLS.js is supported\n    if (Hls.isSupported()) {\n      const hls = new Hls({\n        enableWorker: true,\n        lowLatencyMode: true,\n        backBufferLength: 90,\n        maxBufferLength: 30,\n        maxMaxBufferLength: 600,\n        maxBufferSize: 60 * 1000 * 1000,\n        maxBufferHole: 0.5,\n        manifestLoadingTimeOut: 10000,\n        manifestLoadingMaxRetry: 2,\n        manifestLoadingRetryDelay: 500,\n        levelLoadingTimeOut: 10000,\n        levelLoadingMaxRetry: 4,\n        levelLoadingRetryDelay: 500,\n        fragLoadingTimeOut: 20000,\n        fragLoadingMaxRetry: 6,\n        fragLoadingRetryDelay: 500,\n        startFragPrefetch: true,\n        autoStartLoad: true,\n        debug: false\n      });\n      hlsRef.current = hls;\n      hls.loadSource(src);\n      hls.attachMedia(video);\n      hls.on(Hls.Events.MANIFEST_PARSED, () => {\n        console.log('HLS manifest parsed, available levels:', hls.levels);\n\n        // Set initial volume\n        video.volume = volume;\n\n        // Auto quality selection\n        if (quality === 'auto') {\n          hls.currentLevel = -1; // Auto\n        } else {\n          const level = parseInt(quality);\n          if (!isNaN(level) && level < hls.levels.length) {\n            hls.currentLevel = level;\n          }\n        }\n\n        // Auto play if isPlaying is true\n        if (isPlaying) {\n          video.play().catch(e => {\n            console.warn('Auto-play prevented:', e);\n          });\n        }\n      });\n      hls.on(Hls.Events.ERROR, (event, data) => {\n        if (data.fatal) {\n          switch (data.type) {\n            case Hls.ErrorTypes.NETWORK_ERROR:\n              console.error('Network error, trying to recover...');\n              hls.startLoad();\n              break;\n            case Hls.ErrorTypes.MEDIA_ERROR:\n              console.error('Media error, trying to recover...');\n              hls.recoverMediaError();\n              break;\n            default:\n              console.error('Fatal HLS error, cannot recover');\n              hls.destroy();\n              break;\n          }\n        }\n      });\n      return () => {\n        if (hlsRef.current) {\n          hlsRef.current.destroy();\n          hlsRef.current = null;\n        }\n      };\n    } else if (video.canPlayType('application/vnd.apple.mpegurl')) {\n      // For Safari and other browsers with native HLS support\n      video.src = src;\n      video.volume = volume;\n      if (isPlaying) {\n        video.play().catch(e => {\n          console.warn('Auto-play prevented:', e);\n        });\n      }\n    } else {\n      console.error('HLS is not supported in this browser');\n    }\n  }, [src]);\n\n  // Handle play/pause\n  useEffect(() => {\n    if (!videoRef.current) return;\n    const video = videoRef.current;\n    if (isPlaying) {\n      video.play().catch(e => {\n        console.warn('Play failed:', e);\n      });\n    } else {\n      video.pause();\n    }\n  }, [isPlaying]);\n\n  // Handle volume changes\n  useEffect(() => {\n    if (!videoRef.current) return;\n    videoRef.current.volume = volume;\n  }, [volume]);\n\n  // Handle quality changes\n  useEffect(() => {\n    if (!hlsRef.current || quality === 'auto') return;\n    const level = parseInt(quality);\n    if (!isNaN(level)) {\n      hlsRef.current.currentLevel = level;\n    }\n  }, [quality]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"relative w-full h-full\",\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      className: `w-full h-full ${className || ''}`,\n      controls: true,\n      playsInline: true,\n      preload: \"auto\",\n      crossOrigin: \"anonymous\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute bottom-4 right-4 bg-black bg-opacity-60 px-3 py-1 rounded text-sm text-white\",\n      children: quality === 'auto' ? 'Auto Quality' : `Quality: ${quality}p`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 144,\n    columnNumber: 5\n  }, this);\n}\n_s(HlsPlayer, \"Rqlfna5Dcz+Q57pf3z8SVTgVPTI=\");\n_c = HlsPlayer;\nexport default HlsPlayer;\nvar _c;\n$RefreshReg$(_c, \"HlsPlayer\");","map":{"version":3,"names":["React","useEffect","useRef","Hls","jsxDEV","_jsxDEV","HlsPlayer","src","isPlaying","volume","quality","className","_s","videoRef","hlsRef","current","video","destroy","isSupported","hls","enableWorker","lowLatencyMode","backBufferLength","maxBufferLength","maxMaxBufferLength","maxBufferSize","maxBufferHole","manifestLoadingTimeOut","manifestLoadingMaxRetry","manifestLoadingRetryDelay","levelLoadingTimeOut","levelLoadingMaxRetry","levelLoadingRetryDelay","fragLoadingTimeOut","fragLoadingMaxRetry","fragLoadingRetryDelay","startFragPrefetch","autoStartLoad","debug","loadSource","attachMedia","on","Events","MANIFEST_PARSED","console","log","levels","currentLevel","level","parseInt","isNaN","length","play","catch","e","warn","ERROR","event","data","fatal","type","ErrorTypes","NETWORK_ERROR","error","startLoad","MEDIA_ERROR","recoverMediaError","canPlayType","pause","children","ref","controls","playsInline","preload","crossOrigin","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/rayuv/OneDrive/Documents/GitHub/Reacttv/src/components/HlsPlayer.jsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\nimport Hls from 'hls.js';\r\n\r\nfunction HlsPlayer({ src, isPlaying, volume, quality, className }) {\r\n  const videoRef = useRef(null);\r\n  const hlsRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (!src || !videoRef.current) return;\r\n\r\n    const video = videoRef.current;\r\n    \r\n    // Cleanup previous HLS instance\r\n    if (hlsRef.current) {\r\n      hlsRef.current.destroy();\r\n      hlsRef.current = null;\r\n    }\r\n\r\n    // Check if HLS.js is supported\r\n    if (Hls.isSupported()) {\r\n      const hls = new Hls({\r\n        enableWorker: true,\r\n        lowLatencyMode: true,\r\n        backBufferLength: 90,\r\n        maxBufferLength: 30,\r\n        maxMaxBufferLength: 600,\r\n        maxBufferSize: 60 * 1000 * 1000,\r\n        maxBufferHole: 0.5,\r\n        manifestLoadingTimeOut: 10000,\r\n        manifestLoadingMaxRetry: 2,\r\n        manifestLoadingRetryDelay: 500,\r\n        levelLoadingTimeOut: 10000,\r\n        levelLoadingMaxRetry: 4,\r\n        levelLoadingRetryDelay: 500,\r\n        fragLoadingTimeOut: 20000,\r\n        fragLoadingMaxRetry: 6,\r\n        fragLoadingRetryDelay: 500,\r\n        startFragPrefetch: true,\r\n        autoStartLoad: true,\r\n        debug: false,\r\n      });\r\n\r\n      hlsRef.current = hls;\r\n\r\n      hls.loadSource(src);\r\n      hls.attachMedia(video);\r\n      \r\n      hls.on(Hls.Events.MANIFEST_PARSED, () => {\r\n        console.log('HLS manifest parsed, available levels:', hls.levels);\r\n        \r\n        // Set initial volume\r\n        video.volume = volume;\r\n        \r\n        // Auto quality selection\r\n        if (quality === 'auto') {\r\n          hls.currentLevel = -1; // Auto\r\n        } else {\r\n          const level = parseInt(quality);\r\n          if (!isNaN(level) && level < hls.levels.length) {\r\n            hls.currentLevel = level;\r\n          }\r\n        }\r\n        \r\n        // Auto play if isPlaying is true\r\n        if (isPlaying) {\r\n          video.play().catch(e => {\r\n            console.warn('Auto-play prevented:', e);\r\n          });\r\n        }\r\n      });\r\n\r\n      hls.on(Hls.Events.ERROR, (event, data) => {\r\n        if (data.fatal) {\r\n          switch (data.type) {\r\n            case Hls.ErrorTypes.NETWORK_ERROR:\r\n              console.error('Network error, trying to recover...');\r\n              hls.startLoad();\r\n              break;\r\n            case Hls.ErrorTypes.MEDIA_ERROR:\r\n              console.error('Media error, trying to recover...');\r\n              hls.recoverMediaError();\r\n              break;\r\n            default:\r\n              console.error('Fatal HLS error, cannot recover');\r\n              hls.destroy();\r\n              break;\r\n          }\r\n        }\r\n      });\r\n\r\n      return () => {\r\n        if (hlsRef.current) {\r\n          hlsRef.current.destroy();\r\n          hlsRef.current = null;\r\n        }\r\n      };\r\n    } else if (video.canPlayType('application/vnd.apple.mpegurl')) {\r\n      // For Safari and other browsers with native HLS support\r\n      video.src = src;\r\n      video.volume = volume;\r\n      \r\n      if (isPlaying) {\r\n        video.play().catch(e => {\r\n          console.warn('Auto-play prevented:', e);\r\n        });\r\n      }\r\n    } else {\r\n      console.error('HLS is not supported in this browser');\r\n    }\r\n  }, [src]);\r\n\r\n  // Handle play/pause\r\n  useEffect(() => {\r\n    if (!videoRef.current) return;\r\n    \r\n    const video = videoRef.current;\r\n    \r\n    if (isPlaying) {\r\n      video.play().catch(e => {\r\n        console.warn('Play failed:', e);\r\n      });\r\n    } else {\r\n      video.pause();\r\n    }\r\n  }, [isPlaying]);\r\n\r\n  // Handle volume changes\r\n  useEffect(() => {\r\n    if (!videoRef.current) return;\r\n    videoRef.current.volume = volume;\r\n  }, [volume]);\r\n\r\n  // Handle quality changes\r\n  useEffect(() => {\r\n    if (!hlsRef.current || quality === 'auto') return;\r\n    \r\n    const level = parseInt(quality);\r\n    if (!isNaN(level)) {\r\n      hlsRef.current.currentLevel = level;\r\n    }\r\n  }, [quality]);\r\n\r\n  return (\r\n    <div className=\"relative w-full h-full\">\r\n      <video\r\n        ref={videoRef}\r\n        className={`w-full h-full ${className || ''}`}\r\n        controls\r\n        playsInline\r\n        preload=\"auto\"\r\n        crossOrigin=\"anonymous\"\r\n      />\r\n      \r\n      <div className=\"absolute bottom-4 right-4 bg-black bg-opacity-60 px-3 py-1 rounded text-sm text-white\">\r\n        {quality === 'auto' ? 'Auto Quality' : `Quality: ${quality}p`}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default HlsPlayer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}